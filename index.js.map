{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/refs.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["export const BASE_URL = \"https://pixabay.com/api/\";\nexport const API_KEY = \"46029261-5480acfc9fcdffed316bd43c0\";\nexport const PER_PAGE = 15;","export const refs = {\n    form: document.querySelector('.js-search-form'),\n    container: document.querySelector('.js-cards-container'),\n    loadMoreBtn: document.querySelector('.js-load-more'),\n    loader: document.querySelector('.js-loader'),\n};","export function createGalleryMarkup(hits, wrapper) {\n    const hitsMarkup = hits\n        .map(hit => `<li class=\"li-gallery\">\n            <div class=\"img-box\">\n                <a class=\"gallery-link\" href=\"${hit.largeImageURL}\">\n            <img\n            class=\"gallery-image\"\n            src=\"${hit.webformatURL}\"\n            alt=\"${hit.tags}\"\n            title=\"${hit.tags}\"\n            /></a></div>\n        <div class=\"description-box\">\n            <div class=\"param-boxes\"><p class=\"parameters\">Likes</p>\n            <p class=\"values\">${hit.likes}</p></div>\n            <div class=\"param-boxes\"><p class=\"parameters\">Views</p>\n            <p class=\"values\">${hit.views}</p></div>\n            <div class=\"param-boxes\"><p class=\"parameters\">Comments</p>\n            <p class=\"values\">${hit.comments}</p></div>\n            <div class=\"param-boxes\"><p class=\"parameters\">Downloads</p>\n            <p class=\"values\">${hit.downloads}</p></div>\n        </div>\n        </li>`\n    )\n        .join('');\n    wrapper.insertAdjacentHTML('beforeend', hitsMarkup);\n}","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from \"axios\";\n\nimport { BASE_URL, API_KEY, PER_PAGE } from \"./js/pixabay-api.js\";\nimport { refs } from \"./js/refs.js\";\nimport { createGalleryMarkup } from \"./js/render-functions.js\";\n\nlet currentPage = 1;\nlet searchQuery = null;\nlet pages = 0;\n\nconst loader = document.getElementById('loader');\n\nrefs.form.addEventListener('submit', handleSubmit);\nrefs.loadMoreBtn.addEventListener('click', handleLoadMore);\n\nfunction handleSubmit(event) {\n    event.preventDefault();\n\n    const form = event.currentTarget;\n    searchQuery = form.elements.newsKeyword.value.trim(); //для видалення пробілів; // Перевизначаємо значення пошукового запиту\n    \n    if (searchQuery === '') { //Перевірка на порожній запит\n        iziToast.show({\n            message: 'Please enter a valid search query',\n            position: 'topCenter',\n            color: 'red',\n        });\n        return;\n    }\n\n    currentPage = 1; // Скидаємо сторінку на 1\n    refs.container.innerHTML = ''; // Очищуємо контейнер перед наступним запитом\n\n    fetchNews(searchQuery, form); // Викликаємо fetchNews з потрібними параметрами\n}\n\nasync function fetchNews(searchQuery, form, currentPage = 1) {\n    const options = new URLSearchParams({\n        q: searchQuery,\n        key: API_KEY,\n        per_page: PER_PAGE,\n        page: currentPage,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: \"true\",\n    });\n\n    const url = `${BASE_URL}?${options}`;\n\n    try {\n        const { data } = await axios.get(url);\n        const { hits, totalHits } = data;\n        pages = Math.ceil(totalHits / PER_PAGE); // Підраховуємо кількість сторінок\n\n        if (!Array.isArray(hits) || hits.length === 0) {\n            iziToast.show({\n                message: `'Sorry, there are no images matching your search query. Please try again!'`,\n                position: 'topCenter',\n                color: 'red',\n            });\n            refs.loadMoreBtn.classList.add('is-hidden'); // Приховуємо кнопку, якщо немає результатів\n            return;\n        }\n\n        createGalleryMarkup(hits, refs.container);\n\n        // Якщо ми на останній сторінці, приховуємо кнопку\n        if (currentPage >= pages) {\n            refs.loadMoreBtn.classList.add('is-hidden');\n            iziToast.show({\n                message: 'You have reached the end of search results.',\n                position: 'topCenter',\n                color: 'blue',\n            });\n        } else {\n            refs.loadMoreBtn.classList.remove('is-hidden'); // Показуємо кнопку після отримання результатів\n        }\n        \n\n        const showBox = new SimpleLightbox('.img-box a', {\n            captions: true,\n            captionsData: 'alt',\n            captionsDelay: 250,\n            overlayOpacity: 0.7,\n            className: 'lightbox',\n        });\n\n        showBox.refresh();  // Оновлюємо галерею\n\n    } catch (error) {\n        console.log(error);\n        iziToast.show({\n            message: 'An error occurred while fetching data',\n            position: 'topCenter',\n            color: 'red',\n        });\n        refs.loadMoreBtn.classList.add('is-hidden'); // Приховуємо кнопку у випадку помилки\n        \n    } finally {\n        loader.classList.add('is-hidden');\n        form.reset();\n    }\n}\n\nasync function handleLoadMore() {\n\n    if (currentPage >= pages) { // Перевіряємо, чи є ще сторінки для завантаження\n\n        // refs.loadMoreBtn.classList.add('is-hidden'); // Приховуємо кнопку\n\n        iziToast.show({\n            message: 'Were sorry, but youve reached the end of search results',\n            position: 'topCenter',\n            color: 'blue',\n        });\n        return;\n    }\n\n    currentPage += 1; // Збільшуємо номер поточної сторінки\n    refs.loader.classList.remove('is-hidden'); // Показуємо лоадер\n\n\n\n    await fetchNews(searchQuery, refs.form, currentPage); // Використовуємо await для асинхронного виклику\n    refs.loader.classList.add('is-hidden'); // Ховаємо лоадер після завантаження\n\n    handleScrollView();  // Викликаємо скролінг після завантаження нових даних\n}\n\nfunction handleScrollView() {\n    const lastHit = refs.container.lastElementChild;\n    \n    const hitHeight = lastHit.getBoundingClientRect().height;\n\n    window.scrollBy({\n        top: hitHeight * 2,\n        left: 0,\n        behavior: \"smooth\",\n        });\n}"],"names":["BASE_URL","API_KEY","PER_PAGE","refs","createGalleryMarkup","hits","wrapper","hitsMarkup","hit","currentPage","searchQuery","pages","loader","handleSubmit","handleLoadMore","event","form","iziToast","fetchNews","options","url","data","axios","totalHits","SimpleLightbox","error","handleScrollView","hitHeight"],"mappings":"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"}